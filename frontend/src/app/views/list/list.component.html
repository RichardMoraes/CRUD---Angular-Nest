<main id="list-component">
  <section id="list-section">
    <header id="list-header">
      <div class="flex max-sm:flex-col max-sm:gap-10 justify-between">
        <h1 class="title">Entidades</h1>
        <button mat-raised-button class="default" [routerLink]="['/criar']">Nova Entidade</button>
      </div>
      <div class="search-input relative">
        <label for="search" class="absolute pointer-events-none">
          <mat-icon>search</mat-icon>
        </label>
        <input id="search" type="text" [(ngModel)]="searchInputModel" (keyup.enter)="onSearchChange($event)" (input)="onSearchChange($event)" #searchInput>
      </div>
    </header>
    <div class="list-container" *ngIf="dataSource">
      <ng-container *ngIf="clientWidth >= 960; else mobileTable" #table>
        <table mat-table [dataSource]="dataSource" matSort
        (matSortChange)="announceSortChange($event)">
          <!-- Name -->
          <ng-container matColumnDef="fantasy_name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Filtrar por nome">
              Nome
            </th>
            <td mat-cell *matCellDef="let element"> {{element.fantasy_name}} </td>
          </ng-container>
          <!-- Region -->
          <ng-container matColumnDef="region">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Filtrar por região">
              Região
            </th>
            <td mat-cell *matCellDef="let element"> {{element.region}} </td>
          </ng-container>
          <!-- Medical Specialties -->
          <ng-container matColumnDef="medical_specialties">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Filtrar por especialidades">
              Especialidades
            </th>
            <td mat-cell *matCellDef="let element" (click)="shared.openMedicalSpecialtiesDialog(element.medical_specialties)"> {{element.medical_specialties}} </td>
          </ng-container>
          <!-- Active Column -->
          <ng-container matColumnDef="active">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Filtrar por Status">
              Status
            </th>
            <td mat-cell *matCellDef="let element">
              {{ element.active ? 'Ativa' : 'Inativa' }}
            </td>
          </ng-container>
          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element">
              <button mat-icon-button (click)="onViewClick(element)">
                <mat-icon>remove_red_eye</mat-icon>
              </button>
              <button mat-icon-button (click)="onEditClick(element)">
                <mat-icon>edit</mat-icon>
              </button>
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </ng-container>
      <ng-container>
        <mat-paginator #paginator
          showFirstLastButtons="true"
          [pageSize]="pageSize"
          [length]="(totalItems$ | async)"
          aria-label="Selecione a página"
          hidePageSize="true"
          id="pagination">
        </mat-paginator>
      </ng-container>
    </div>
  </section>
</main>

<ng-template #mobileTable>
  <table mat-table [dataSource]="dataSource" matSort (matSortChange)="announceSortChange($event)">
    <!-- Name -->
    <ng-container matColumnDef="fantasy_name">
      <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Filtrar por nome">
        Nome
      </th>
      <td mat-cell *matCellDef="let element"> {{element.fantasy_name}} </td>
    </ng-container>
    <!-- Region -->
    <ng-container *ngIf="clientWidth > 600" matColumnDef="region">
      <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Filtrar por região">
        Região
      </th>
      <td mat-cell *matCellDef="let element"> {{element.region}} </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"
    [routerLink]="[row.name]">
    </tr>
  </table>
</ng-template>

